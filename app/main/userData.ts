import { app, ipcMain } from 'electron';
import path from 'path';
import fileAction from '@common/utils/file';

// ğŸ‘‡ 1. å¾—åˆ°åº”ç”¨ç¨‹åºè®¾ç½®æ–‡ä»¶çš„æ–‡ä»¶å¤¹ï¼Œç„¶åæŸ¥çœ‹ resumeCache ç›®å½•
const resumeCachePath = path.resolve(app.getPath('userData'), 'resumeCache');

// ğŸ‘‡ 2 resumeCache æ–‡ä»¶å¤¹æ˜¯å¦å¯è¯»
fileAction
  .canRead(resumeCachePath)
  .then(() => {
    // ğŸ‘‡ 2.1 resumeCache å¯è¯»æƒ…å†µä¸‹ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ theme.config.json
    fileAction.hasFile(`${resumeCachePath}/index.json`).catch(() => {
      // 2.1.1 ä¸å­˜åœ¨åˆ™é»˜è®¤åˆ›å»º
      createresumeCacheJson();
    });
  })
  .catch(() => {
    // ğŸ‘‡ 2.3 resumeCache æ–‡ä»¶å¤¹ä¸å¯è¯»ï¼Œè¯´æ˜ä¸å­˜åœ¨æ­¤æ–‡ä»¶å¤¹ï¼Œåˆ™æ–°å¢æ–‡ä»¶å¤¹
    fileAction.mkdirDir(resumeCachePath).then(() => {
      // 2.3.1 å¹¶é»˜è®¤åˆ›å»ºæ–‡ä»¶
      createresumeCacheJson();
    });
  });

// åˆ›å»ºé»˜è®¤ theme.config.json
const createresumeCacheJson = () => {
  fileAction?.write(
    `${resumeCachePath}/index.json`,
    JSON.stringify({
      base: {
        avatar: '',
        username: 'é™ˆæ”¿æ™“',
        area: 'å››å·Â·æˆéƒ½',
        school: 'è¥¿å—çŸ³æ²¹å¤§å­¦',
        major: 'è½¯ä»¶å·¥ç¨‹',
        degree: 'æœ¬ç§‘',
        hometown: 'å››å·',
        onSchoolTime: {
          beginTime: '2021.09',
          endTime: '2025.06',
        },
      },
      contact: {
        phone: '147****7746',
        email: '1930998954@qq.com',
        github: 'https://github.com/Yeatsczx',
        juejin: 'https://juejin.cn/user/237942497623806',
      },
      work: {
        job: 'å‰ç«¯å·¥ç¨‹å¸ˆ',
        city: 'ä¸Šæµ·ï½œæˆéƒ½ï½œåŒ—äº¬',
        cityList: ['ä¸Šæµ·', 'æˆéƒ½', 'åŒ—äº¬'],
      },
      skill:
        'ç†Ÿæ‚‰ Vue.jsï¼Œäº†è§£æ•°æ®åŒå‘ç»‘å®šåŸç†ã€é˜…è¯»è¿‡ NextTick æºç ï½œç†Ÿæ‚‰ Reactï¼Œäº†è§£å¹¶ä½¿ç”¨ Hooks ç‰¹æ€§ï¼Œé˜…è¯»è¿‡ redux æºç ï¼Œå¼€å‘ rc-redux-model ä¸­é—´ä»¶ï½œé˜…è¯»è¿‡ Antd éƒ¨åˆ†ä¼˜ç§€ç»„ä»¶æºç ï¼Œå¹¶å‚è€ƒå€Ÿé‰´ï¼Œå¼€å‘ç»„å†… UI ç»„ä»¶åº“ï½œäº†è§£ Vscodeï¼Œå¼€å‘ç»„å†…é¡¹ç›®è¾…åŠ©å·¥å…· vscode-beehive-extension æ’ä»¶ï½œäº†è§£ Webpack ç¼–è¯‘åŸç†ï¼Œäº†è§£ babel è½¬ç åŸç†ï¼Œç¼–å†™è¿‡ babel æ’ä»¶ï½œäº†è§£ Electronï¼Œäº†è§£ Node.js ä»¥åŠ Git å›¢é˜Ÿåä½œå¼€å‘å·¥å…·ï½œäº†è§£è®¾è®¡æ¨¡å¼ï¼Œå¯¹äºç‰¹å®šåœºæ™¯ï¼Œèƒ½é‡‡ç”¨åˆé€‚çš„è®¾è®¡æ¨¡å¼è¿›è¡Œè§£å†³ï½œäº†è§£ MYSQLï¼Œäº†è§£æ•°æ®åº“ä¼˜åŒ–å¸¸ç”¨æ–¹æ³•ï½œäº†è§£åŸºäºå¾®ä¿¡å…¬ä¼—å·åº”ç”¨å¼€å‘ï¼Œé‡‡ç”¨ Taro å¼€å‘å¾®ä¿¡å°ç¨‹åºï¼Œå…·å¤‡è‰¯å¥½çš„ç½‘ç»œåŸºç¡€çŸ¥è¯†',
      skillList: [
        'ç†Ÿæ‚‰ Vue.jsï¼Œäº†è§£æ•°æ®åŒå‘ç»‘å®šåŸç†ã€é˜…è¯»è¿‡ NextTick æºç ',
        'ç†Ÿæ‚‰ Reactï¼Œäº†è§£å¹¶ä½¿ç”¨ Hooks ç‰¹æ€§ï¼Œé˜…è¯»è¿‡ redux æºç ï¼Œå¼€å‘ rc-redux-model ä¸­é—´ä»¶',
        'é˜…è¯»è¿‡ Antd éƒ¨åˆ†ä¼˜ç§€ç»„ä»¶æºç ï¼Œå¹¶å‚è€ƒå€Ÿé‰´ï¼Œå¼€å‘ç»„å†… UI ç»„ä»¶åº“',
        'äº†è§£ Vscodeï¼Œå¼€å‘ç»„å†…é¡¹ç›®è¾…åŠ©å·¥å…· vscode-beehive-extension æ’ä»¶',
        'äº†è§£ Webpack ç¼–è¯‘åŸç†ï¼Œäº†è§£ babel è½¬ç åŸç†ï¼Œç¼–å†™è¿‡ babel æ’ä»¶',
        'äº†è§£ Electronï¼Œäº†è§£ Node.js ä»¥åŠ Git å›¢é˜Ÿåä½œå¼€å‘å·¥å…·',
        'äº†è§£è®¾è®¡æ¨¡å¼ï¼Œå¯¹äºç‰¹å®šåœºæ™¯ï¼Œèƒ½é‡‡ç”¨åˆé€‚çš„è®¾è®¡æ¨¡å¼è¿›è¡Œè§£å†³',
        'äº†è§£ MYSQLï¼Œäº†è§£æ•°æ®åº“ä¼˜åŒ–å¸¸ç”¨æ–¹æ³•',
        'äº†è§£åŸºäºå¾®ä¿¡å…¬ä¼—å·åº”ç”¨å¼€å‘ï¼Œé‡‡ç”¨ Taro å¼€å‘å¾®ä¿¡å°ç¨‹åºï¼Œå…·å¤‡è‰¯å¥½çš„ç½‘ç»œåŸºç¡€çŸ¥è¯†',
      ],
      evaluation:
        'å…·å¤‡è‰¯å¥½è¯­è¨€è¡¨è¾¾èƒ½åŠ›å’Œæ²Ÿé€šèƒ½åŠ›ï¼Œèƒ½å¿«é€Ÿèå…¥å›¢é˜Ÿï¼Œé€‚åº”æ–°ç¯å¢ƒ|å…·æœ‰ä»£ç æ´ç™–ï¼Œå‰åç«¯åˆ†ç¦»ï¼Œè‡ªæˆ‘å­¦ä¹ èƒ½åŠ›å¼ºï¼Œå¯¹æ–°æŠ€æœ¯å…·æœ‰é’»ç ”ç²¾ç¥',
      certificate: 'å››å·xxå¤§èµ›å‚ä¸å¥–',
      certificateList: ['å››å·xxå¤§èµ›å‚ä¸å¥–'],
      schoolExperience: [
        {
          beginTime: '2021.09',
          endTime: '2022.06',
          post: 'æ–‡è‰ºéƒ¨ä¼šé•¿',
          department: 'æ ¡å›¢å§”å­¦ç”Ÿä¼š',
          content:
            'è®¡åˆ’ã€ç»„ç»‡ã€åè°ƒå„å¹´çº§å­¦ç”Ÿç»„ç»‡çš„æ–‡è‰ºå’Œæ–‡åŒ–å¨±ä¹æ´»åŠ¨ï½œæ‰¿åŠå¥½å­¦ç”Ÿä¼šéƒ¨çš„å­¦ç”Ÿæ–‡è‰ºæ™šä¼šã€‚æœ‰æ•ˆåœ°ä¸ç¤¾å›¢éƒ¨å¼€å±•åˆä½œé¡¹ç›®',
          parseContent: [
            'è®¡åˆ’ã€ç»„ç»‡ã€åè°ƒå„å¹´çº§å­¦ç”Ÿç»„ç»‡çš„æ–‡è‰ºå’Œæ–‡åŒ–å¨±ä¹æ´»åŠ¨',
            'æ‰¿åŠå¥½å­¦ç”Ÿä¼šéƒ¨çš„å­¦ç”Ÿæ–‡è‰ºæ™šä¼šã€‚æœ‰æ•ˆåœ°ä¸ç¤¾å›¢éƒ¨å¼€å±•åˆä½œé¡¹ç›®',
          ],
          date: 1621145137865,
        },
      ],
      workExperience: [
        {
          beginTime: '2021.09',
          endTime: '2022.04',
          post: 'å‰ç«¯å·¥ç¨‹å¸ˆ',
          department: 'å››å·xxå¤§å­¦ç½‘ç»œä¸­å¿ƒ',
          content:
            'æ‹…ä»»xxå·¥ä½œå®¤å‰ç«¯å·¥ç¨‹å¸ˆï¼Œä¸å››å·xxå¤§å­¦ç½‘ç»œä¸­å¿ƒåˆä½œï¼Œå›´ç»•å¾®ä¿¡ä¼ä¸šå·å¼€å‘æˆ–ä¸»å¯¼å¤šä¸ªåº”ç”¨ï½œä»»èŒæœŸé—´åŸºäºå¾®ä¿¡ä¼ä¸šå·å¼€å‘æ ¡å†…é—²ä½™å¸‚åœºï¼Œé‡‡ç”¨Vue.jsä¸»å¯¼å¼€å‘ï¼Œå¹¶ä¸å››å·xxxç§‘æŠ€æœ‰é™å…¬å¸åˆä½œï¼Œä¸»å¯¼å¼€å‘è¯¥å…¬å¸å®˜ç½‘åŠåå°ç®¡ç†',
          parseContent: [
            'æ‹…ä»»xxå·¥ä½œå®¤å‰ç«¯å·¥ç¨‹å¸ˆï¼Œä¸å››å·xxå¤§å­¦ç½‘ç»œä¸­å¿ƒåˆä½œï¼Œå›´ç»•å¾®ä¿¡ä¼ä¸šå·å¼€å‘æˆ–ä¸»å¯¼å¤šä¸ªåº”ç”¨',
            'ä»»èŒæœŸé—´åŸºäºå¾®ä¿¡ä¼ä¸šå·å¼€å‘æ ¡å†…é—²ä½™å¸‚åœºï¼Œé‡‡ç”¨Vue.jsä¸»å¯¼å¼€å‘ï¼Œå¹¶ä¸å››å·xxxç§‘æŠ€æœ‰é™å…¬å¸åˆä½œï¼Œä¸»å¯¼å¼€å‘è¯¥å…¬å¸å®˜ç½‘åŠåå°ç®¡ç†',
          ],
          date: 1621145137865,
        },
      ],
      projectExperience: [
        {
          beginTime: '2021.03',
          endTime: '2021.05',
          projectName: 'visResumeMook å¯è§†åŒ–ç®€å†å¹³å°',
          post: 'å‰ç«¯å·¥ç¨‹å¸ˆ',
          content:
            'Electron + React Hooks æ‰“é€ ç®€å†å¹³å°ï¼Œåªéœ€è¾“å…¥ä¸€æ¬¡ä¿¡æ¯ï¼Œå¥—ç”¨å¤šä»½æ¨¡ç‰ˆï½œé€šè¿‡ jsonfile æ–¹å¼å®ç°ä¸»é¢˜æ¢è‚¤ï¼Œæ”¯æŒå¯¼å‡º PDF ç®€å†æ–‡æ¡£ï½œé€šè¿‡ indexDB æ–¹å¼å®ç°å†å²ç®€å†ç¼“å­˜ï¼Œé€šè¿‡å¯è§†åŒ–æ‹–æ‹½å½¢å¼ï¼Œè‡ªå®šä¹‰ç»„ä»¶æ¨¡ç‰ˆ',
          parseContent: [
            'Electron + React Hooks æ‰“é€ ç®€å†å¹³å°ï¼Œåªéœ€è¾“å…¥ä¸€æ¬¡ä¿¡æ¯ï¼Œå¥—ç”¨å¤šä»½æ¨¡ç‰ˆ',
            'é€šè¿‡ jsonfile æ–¹å¼å®ç°ä¸»é¢˜æ¢è‚¤ï¼Œæ”¯æŒå¯¼å‡º PDF ç®€å†æ–‡æ¡£',
            'é€šè¿‡ indexDB æ–¹å¼å®ç°å†å²ç®€å†ç¼“å­˜ï¼Œé€šè¿‡å¯è§†åŒ–æ‹–æ‹½å½¢å¼ï¼Œè‡ªå®šä¹‰ç»„ä»¶æ¨¡ç‰ˆ',
          ],
          date: 1621145137865,
        },
      ],
    }),
    'utf8'
  );
};

// ğŸ‘‡ å“åº”æ¸²æŸ“è¿›ç¨‹æƒ³å¾—åˆ°çš„ userData è·¯å¾„ï¼Œå› ä¸º app æ¨¡å—åªèƒ½åœ¨ä¸»è¿›ç¨‹ä¸­ä½¿ç”¨
ipcMain.on('Electron:get-userData-path', (event, arg) => {
  event.reply('Electron:reply-userData-path', app.getPath('userData'));
});
